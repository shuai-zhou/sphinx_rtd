

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Activity Space &mdash; GPS2space 0.1.3 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Measuring Distance" href="measuring_distance.html" />
    <link rel="prev" title="Building Spatial Data" href="building_spatial_data.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> GPS2space
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_spatial_data.html">Building Spatial Data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Activity Space</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Buffer-based-activity-space">Buffer-based activity space</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Convex-hull-based-space">Convex hull-based space</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Which-method-to-choose">Which method to choose</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Shared-space">Shared space</a></li>
<li class="toctree-l1"><a class="reference internal" href="measuring_distance.html">Measuring Distance</a></li>
<li class="toctree-l1"><a class="reference internal" href="tips.html">Tips</a></li>
</ul>
<p class="caption"><span class="caption-text">Useful Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="useful_links.html">Useful Links</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
<p class="caption"><span class="caption-text">Credits</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GPS2space</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Activity Space</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/measuring_activity_space.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Activity-Space">
<h1>Activity Space<a class="headerlink" href="#Activity-Space" title="Permalink to this headline">¶</a></h1>
<p>With the Point GeoDataFrame, we can measure activity space by building geometric shapes using minimum bounding box methods. There are several ways to build minimum bounding box, including buffer, convex hull, circle, envelope, etc., each with pros and cons depending on the geographic distribution of the Point GeoDataFrame. Currently, we support buffer and convex hull methods in building minimum bounding box and calculating corresponding activity space. The following examples demonstrate how to
implement buffer- and convex hull-based activity space. We will use the example data we used in the last section as an example to illustrate how to calculate buffer- and convex hull-based activity space. You can refer to <a class="reference external" href="https://github.com/shuai-zhou/gps2space/blob/master/notebooks/createdata.ipynb">here</a> for how we compile the data.</p>
<p>We first need to import libraries we will be using for the examples.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<p>We then load the data and create spatial data using the <code class="docutils literal notranslate"><span class="pre">df_to_gdf</span></code> method as we did in the last section.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/example.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pid</th>
      <th>timestamp</th>
      <th>latitude</th>
      <th>longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P2</td>
      <td>2020-04-27 10:42:22.162176000</td>
      <td>40.993799</td>
      <td>-76.669419</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P2</td>
      <td>2020-06-02 01:12:45.308505600</td>
      <td>39.946904</td>
      <td>-78.926234</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P2</td>
      <td>2020-05-08 23:47:33.718185600</td>
      <td>41.237403</td>
      <td>-79.252317</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P2</td>
      <td>2020-04-26 14:31:12.100310400</td>
      <td>41.991390</td>
      <td>-77.467769</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P2</td>
      <td>2020-03-31 15:53:27.777897600</td>
      <td>41.492674</td>
      <td>-76.542921</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>There are two persons, P1 and P2, and their locations along with timestamp.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gps2space</span> <span class="kn">import</span> <span class="n">geodf</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gdf</span> <span class="o">=</span> <span class="n">geodf</span><span class="o">.</span><span class="n">df_to_gdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="n">gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pid</th>
      <th>timestamp</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P2</td>
      <td>2020-04-27 10:42:22.162176000</td>
      <td>40.993799</td>
      <td>-76.669419</td>
      <td>POINT (-76.66942 40.99380)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P2</td>
      <td>2020-06-02 01:12:45.308505600</td>
      <td>39.946904</td>
      <td>-78.926234</td>
      <td>POINT (-78.92623 39.94690)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P2</td>
      <td>2020-05-08 23:47:33.718185600</td>
      <td>41.237403</td>
      <td>-79.252317</td>
      <td>POINT (-79.25232 41.23740)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P2</td>
      <td>2020-04-26 14:31:12.100310400</td>
      <td>41.991390</td>
      <td>-77.467769</td>
      <td>POINT (-77.46777 41.99139)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P2</td>
      <td>2020-03-31 15:53:27.777897600</td>
      <td>41.492674</td>
      <td>-76.542921</td>
      <td>POINT (-76.54292 41.49267)</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pa</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;../data/pacounty.shp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;pid&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/measuring_activity_space_10_0.png" src="_images/measuring_activity_space_10_0.png" />
</div>
</div>
<p>The figure shows the distribution of our data with two different colors representing P1 and P2, respectively.</p>
<div class="section" id="Buffer-based-activity-space">
<h2>Buffer-based activity space<a class="headerlink" href="#Buffer-based-activity-space" title="Permalink to this headline">¶</a></h2>
<p>We import the <code class="docutils literal notranslate"><span class="pre">space</span></code> module. The <code class="docutils literal notranslate"><span class="pre">space</span></code> module has a function <code class="docutils literal notranslate"><span class="pre">buffer_space</span></code> which takes four parameters:</p>
<ul class="simple">
<li><p>gdf: This is your GeoDataFrame</p></li>
<li><p>dist: This is the buffer distance, the default value is 0 meter</p></li>
<li><p>dissolve: This is the level of aggregating from which you aggregate points to form polygon, the default value is week</p></li>
<li><p>proj: This is the EPSG identifier you want to use to project your spatial data, the default value is 2163</p></li>
</ul>
<p><strong>Please note:</strong> Buffer distance and your projection are related. For raw Lat/Long coordinate pairs (often called unprojected data), the unit is degree. It is not usual to buffer geometry in degrees. You have to decide which projection system is most appropriate for your own data based on the geographical location. For example, <strong>EPSG:2163</strong> is commonly used in the United States, and the unit of distance is meter. See <a class="reference external" href="https://epsg.io/">here</a> for more information about EPSG identifier.</p>
<p>In this example, we will calculate activity space on a weekly basis. Before that, we need to create a column represents <code class="docutils literal notranslate"><span class="pre">week</span></code> from the timestamp. We will also create <code class="docutils literal notranslate"><span class="pre">year</span></code> and <code class="docutils literal notranslate"><span class="pre">month</span></code> just to show how you can obtain those information from timestamp. It is better to include <code class="docutils literal notranslate"><span class="pre">infer_datetime_format=True</span></code> because this will make <code class="docutils literal notranslate"><span class="pre">datetime</span></code> function much faster, especially when dealing with big data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span> <span class="n">infer_datetime_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
<span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;week&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">week</span>
<span class="n">gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pid</th>
      <th>timestamp</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>geometry</th>
      <th>year</th>
      <th>month</th>
      <th>week</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P2</td>
      <td>2020-04-27 10:42:22.162176000</td>
      <td>40.993799</td>
      <td>-76.669419</td>
      <td>POINT (-76.66942 40.99380)</td>
      <td>2020</td>
      <td>4</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P2</td>
      <td>2020-06-02 01:12:45.308505600</td>
      <td>39.946904</td>
      <td>-78.926234</td>
      <td>POINT (-78.92623 39.94690)</td>
      <td>2020</td>
      <td>6</td>
      <td>23</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P2</td>
      <td>2020-05-08 23:47:33.718185600</td>
      <td>41.237403</td>
      <td>-79.252317</td>
      <td>POINT (-79.25232 41.23740)</td>
      <td>2020</td>
      <td>5</td>
      <td>19</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P2</td>
      <td>2020-04-26 14:31:12.100310400</td>
      <td>41.991390</td>
      <td>-77.467769</td>
      <td>POINT (-77.46777 41.99139)</td>
      <td>2020</td>
      <td>4</td>
      <td>17</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P2</td>
      <td>2020-03-31 15:53:27.777897600</td>
      <td>41.492674</td>
      <td>-76.542921</td>
      <td>POINT (-76.54292 41.49267)</td>
      <td>2020</td>
      <td>3</td>
      <td>14</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now that we have the week column, we can calculate buffer-based activity space on a weekly basis using the <code class="docutils literal notranslate"><span class="pre">buffer_space</span></code> function and pass your choice to the four parameters we mentioned before. In this example, we will use 100 meters as buffer distance and project our data in <strong>EPSG:2163</strong>.</p>
<p><strong>Please also note</strong> that Pandas use the <a class="reference external" href="https://en.wikipedia.org/wiki/ISO_week_date">ISO week date system</a> to determine week of a specific date. Sometimes the results is not intuitive, for example:</p>
<p><code class="docutils literal notranslate"><span class="pre">print(pd.Timestamp('01-01-2017</span> <span class="pre">12:00:00').week)</span></code></p>
<p>This will give a result of week number 52, rather than week number 1. This is not necessary wrong, see <a class="reference external" href="https://stackoverflow.com/questions/44372048/python-pandas-timestamp-week-returns-52-for-first-day-of-year/44372130">discussion</a> here. You can work around this issue (if it is a issue to you) by using <code class="docutils literal notranslate"><span class="pre">DataOffset</span></code> (see <a class="reference external" href="https://stackoverflow.com/questions/53175035/issues-in-getting-week-numbers-with-weeks-starting-on-sunday-in-python">discussion</a> here) like the following (although we
do not recommend doing this):</p>
<p><code class="docutils literal notranslate"><span class="pre">gdf['week_new']</span> <span class="pre">=</span> <span class="pre">(gdf['timestamp']</span> <span class="pre">+</span> <span class="pre">pd.DateOffset(days=1)).dt.week</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gps2space</span> <span class="kn">import</span> <span class="n">space</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">buff_space</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">buffer_space</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">dissolve</span><span class="o">=</span><span class="s1">&#39;week&#39;</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="mi">2163</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">buff_space</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>week</th>
      <th>geometry</th>
      <th>pid</th>
      <th>timestamp</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>year</th>
      <th>month</th>
      <th>buff_area</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>MULTIPOLYGON (((1720869.317 -318189.673, 17208...</td>
      <td>P2</td>
      <td>2020-01-05 07:50:30.081292799</td>
      <td>40.199583</td>
      <td>-79.496295</td>
      <td>2020</td>
      <td>1</td>
      <td>219558.394338</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>MULTIPOLYGON (((1825885.684 -276078.791, 18258...</td>
      <td>P2</td>
      <td>2020-01-09 09:16:06.603628800</td>
      <td>40.156435</td>
      <td>-77.230625</td>
      <td>2020</td>
      <td>1</td>
      <td>94096.454716</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>MULTIPOLYGON (((1890877.371 -286206.003, 18908...</td>
      <td>P2</td>
      <td>2020-01-16 04:50:28.301625600</td>
      <td>40.705452</td>
      <td>-78.310757</td>
      <td>2020</td>
      <td>1</td>
      <td>188192.909433</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>MULTIPOLYGON (((1745374.124 -298916.733, 17453...</td>
      <td>P2</td>
      <td>2020-01-26 07:27:26.824550400</td>
      <td>41.820474</td>
      <td>-76.526561</td>
      <td>2020</td>
      <td>1</td>
      <td>282289.364149</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>MULTIPOLYGON (((1940968.545 -274223.560, 19409...</td>
      <td>P2</td>
      <td>2020-01-31 16:15:44.942918400</td>
      <td>40.820036</td>
      <td>-78.510162</td>
      <td>2020</td>
      <td>1</td>
      <td>219558.394338</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We can double-check what is the unit in <strong>EPSG:2163</strong> projection system:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">buff_space</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">axis_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unit_name</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;metre&#39;
</pre></div></div>
</div>
<p>The result is “metre”. Accordingly, the <code class="docutils literal notranslate"><span class="pre">buff_area</span></code> column represents the buffer-based activity space measured in square meters on a weekly basis. You probably noticed that this example did not separate P1 and P2 in calculating activity space. Currently, the <code class="docutils literal notranslate"><span class="pre">dissolve</span></code> parameter only accept one string, not a list of strings. To get activity space for each person on a weekly basis is easy, all you need to do is to concatenate <code class="docutils literal notranslate"><span class="pre">pid</span></code> and <code class="docutils literal notranslate"><span class="pre">week</span></code>, then dissolve by the newly created column.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;person_week&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;pid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;week&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">buff_space_person_week</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">buffer_space</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">dissolve</span><span class="o">=</span><span class="s1">&#39;person_week&#39;</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="mi">2163</span><span class="p">)</span>
<span class="n">buff_space_person_week</span><span class="p">[[</span><span class="s1">&#39;person_week&#39;</span><span class="p">,</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="s1">&#39;week&#39;</span><span class="p">,</span><span class="s1">&#39;buff_area&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>person_week</th>
      <th>geometry</th>
      <th>year</th>
      <th>month</th>
      <th>week</th>
      <th>buff_area</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P1_1</td>
      <td>MULTIPOLYGON (((1743324.165 -263838.253, 17433...</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>94096.454716</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P1_10</td>
      <td>MULTIPOLYGON (((1910985.055 -311470.562, 19109...</td>
      <td>2020</td>
      <td>3</td>
      <td>10</td>
      <td>156827.424527</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P1_11</td>
      <td>POLYGON ((1639281.583 -176601.784, 1639281.101...</td>
      <td>2020</td>
      <td>3</td>
      <td>11</td>
      <td>31365.484905</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P1_12</td>
      <td>MULTIPOLYGON (((2042446.974 -187451.693, 20424...</td>
      <td>2020</td>
      <td>3</td>
      <td>12</td>
      <td>62730.969811</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P1_13</td>
      <td>MULTIPOLYGON (((1736946.385 -338001.805, 17369...</td>
      <td>2020</td>
      <td>3</td>
      <td>13</td>
      <td>94096.454716</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now you get the activity space for each person on a weekly basis. Likewise, you can easily get each person’s activity space on a yearly basis by simply concatenating <code class="docutils literal notranslate"><span class="pre">pid</span></code> and <code class="docutils literal notranslate"><span class="pre">year</span></code>, or activity space on a monthly basis by simply concatenating <code class="docutils literal notranslate"><span class="pre">pid</span></code> and <code class="docutils literal notranslate"><span class="pre">month</span></code></p>
<p>You can select the columns you are interested and save the GeoDataFrame to a spatial dataset or non-spatial dataset. Here, we save the GeoDataFrame to a <code class="docutils literal notranslate"><span class="pre">shp</span></code> file and a <code class="docutils literal notranslate"><span class="pre">csv</span></code> file.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">buff_space_person_week</span><span class="p">[[</span><span class="s1">&#39;person_week&#39;</span><span class="p">,</span><span class="s1">&#39;buff_area&#39;</span><span class="p">,</span><span class="s1">&#39;geometry&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;../data/buffer_space.shp&#39;</span><span class="p">)</span>
<span class="n">buff_space_person_week</span><span class="p">[[</span><span class="s1">&#39;person_week&#39;</span><span class="p">,</span><span class="s1">&#39;buff_area&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/buffer_space.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Convex-hull-based-space">
<h2>Convex hull-based space<a class="headerlink" href="#Convex-hull-based-space" title="Permalink to this headline">¶</a></h2>
<p>We can also calculate the convex hull-based activity space using the <code class="docutils literal notranslate"><span class="pre">convex_space</span></code> function. The <code class="docutils literal notranslate"><span class="pre">convex_space</span></code> takes three parameters:</p>
<ul class="simple">
<li><p>gdf: This is your GeoDataFrame</p></li>
<li><p>group: This is the level of aggregating from which you group points to form polygon, the default value is week</p></li>
<li><p>proj: This is the EPSG identifier you want to use to project your spatial data, the default value is 2163</p></li>
</ul>
<p>In this example, we will dissolve the points by <code class="docutils literal notranslate"><span class="pre">person_week</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">convex_space</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">convex_space</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s1">&#39;person_week&#39;</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="mi">2163</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">convex_space</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>person_week</th>
      <th>geometry</th>
      <th>convx_area</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P1_1</td>
      <td>POLYGON ((-79.08352 40.61927, -78.64613 41.031...</td>
      <td>0.459119</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P1_10</td>
      <td>POLYGON ((-77.29803 39.81326, -78.33096 41.824...</td>
      <td>2.980511</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P1_11</td>
      <td>POINT (-80.05021 41.60526)</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P1_12</td>
      <td>LINESTRING (-78.86727 41.79762, -75.39833 40.5...</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P1_13</td>
      <td>POLYGON ((-79.36647 39.99230, -77.46196 41.851...</td>
      <td>1.425932</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">convx_area</span></code> column represents the convex hull-based activity space measured in square meters in <strong>EPSG:2163</strong>. This dataset is not perfect, we see that in Week 11 for P1, there is only one point, therefore a Point shape is constructed and 0 is returned for its area. Similarly, in Week 12 for P1, a line shape is constructed rather than a Polygon and 0 is returned for its area. You can also save this GeoDataFrame to a spatial dataset or a non-spatial dataset just like what we have done for
the buffer-based activity space measure.</p>
</div>
<div class="section" id="Which-method-to-choose">
<h2>Which method to choose<a class="headerlink" href="#Which-method-to-choose" title="Permalink to this headline">¶</a></h2>
<p>There are pros and cons of the buffer- and convex hull-based measure of activity space. Knowing how they work will help you understand the process and choose the appropriate method.</p>
<p>The following figure shows the buffer-based activity space (in red color) and convex hull-based activity space (in blue color) from a set of Lat/Long coordinate pairs (in black color). In essence, what buffer-based activity space does is: first, draw a circle around every point using specified buffer distance, then dissolve all the buffers into a single feature to form a Polygon. What convex hull-based activity space does is to line up the outermost points and form the polygon.</p>
<p><img alt="buffconvex300" src="_images/buffconvex300.png" /></p>
<p>The pro of buffer-based activity space is that it works with even only one point where the activity space is eventually the area of the circle. However, you have to specify the buffer distance which sometimes is arbitrary and varies across disciplines.</p>
<p>The convex hull-based activity space does not need any arbitrary parameter. However, if there are two or three points that can line up, it is impossible to form an enclosing shape, and the returned activity space will be 0. In addition, if there are extreme points that are beyond the point cluster, the convex hull-based activity space will be inflated.</p>
<p>The choice of methods depends on which one makes more sense for you research questions and which one is widely acceptable in your field.</p>
<p>Other than the buffer- and convex hull-based minimum bounding box, there are other methods, for example, circle, envelope, concave, etc. We may (or may not) include those methods in our package later on.</p>
</div>
</div>
<div class="section" id="Shared-space">
<h1>Shared space<a class="headerlink" href="#Shared-space" title="Permalink to this headline">¶</a></h1>
<p>Activity space can act as the building box for compiling shared space to indicate interactions by overlaying the activity space at different scales. In the following example, we provide a workflow for building shared space from activity space between P1 and P2 on a weekly basis. We use the buffer-based activity space and redo it with buffer distance of 1000 meter to get more overlapping areas for P1 and P2.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pid</th>
      <th>timestamp</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>geometry</th>
      <th>year</th>
      <th>month</th>
      <th>week</th>
      <th>person_week</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P2</td>
      <td>2020-04-27 10:42:22.162176000</td>
      <td>40.993799</td>
      <td>-76.669419</td>
      <td>POINT (-76.66942 40.99380)</td>
      <td>2020</td>
      <td>4</td>
      <td>18</td>
      <td>P2_18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P2</td>
      <td>2020-06-02 01:12:45.308505600</td>
      <td>39.946904</td>
      <td>-78.926234</td>
      <td>POINT (-78.92623 39.94690)</td>
      <td>2020</td>
      <td>6</td>
      <td>23</td>
      <td>P2_23</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P2</td>
      <td>2020-05-08 23:47:33.718185600</td>
      <td>41.237403</td>
      <td>-79.252317</td>
      <td>POINT (-79.25232 41.23740)</td>
      <td>2020</td>
      <td>5</td>
      <td>19</td>
      <td>P2_19</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P2</td>
      <td>2020-04-26 14:31:12.100310400</td>
      <td>41.991390</td>
      <td>-77.467769</td>
      <td>POINT (-77.46777 41.99139)</td>
      <td>2020</td>
      <td>4</td>
      <td>17</td>
      <td>P2_17</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P2</td>
      <td>2020-03-31 15:53:27.777897600</td>
      <td>41.492674</td>
      <td>-76.542921</td>
      <td>POINT (-76.54292 41.49267)</td>
      <td>2020</td>
      <td>3</td>
      <td>14</td>
      <td>P2_14</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">buff1000m</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">buffer_space</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">dissolve</span><span class="o">=</span><span class="s1">&#39;person_week&#39;</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="mi">2163</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">buff1000m</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>person_week</th>
      <th>geometry</th>
      <th>pid</th>
      <th>timestamp</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>year</th>
      <th>month</th>
      <th>week</th>
      <th>buff_area</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P1_1</td>
      <td>MULTIPOLYGON (((1744224.165 -263838.253, 17442...</td>
      <td>P1</td>
      <td>2020-01-05 02:34:34.559443200</td>
      <td>40.619272</td>
      <td>-79.083519</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>9.409645e+06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P1_10</td>
      <td>MULTIPOLYGON (((1911885.055 -311470.562, 19118...</td>
      <td>P1</td>
      <td>2020-03-04 15:38:10.246531200</td>
      <td>40.720979</td>
      <td>-75.939881</td>
      <td>2020</td>
      <td>3</td>
      <td>10</td>
      <td>1.568274e+07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P1_11</td>
      <td>POLYGON ((1640181.583 -176601.784, 1640176.767...</td>
      <td>P1</td>
      <td>2020-03-14 21:43:34.435401600</td>
      <td>41.605263</td>
      <td>-80.050210</td>
      <td>2020</td>
      <td>3</td>
      <td>11</td>
      <td>3.136548e+06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P1_12</td>
      <td>MULTIPOLYGON (((2043346.974 -187451.693, 20433...</td>
      <td>P1</td>
      <td>2020-03-19 15:47:51.952416000</td>
      <td>41.797624</td>
      <td>-78.867266</td>
      <td>2020</td>
      <td>3</td>
      <td>12</td>
      <td>6.273097e+06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P1_13</td>
      <td>MULTIPOLYGON (((1737846.385 -338001.805, 17378...</td>
      <td>P1</td>
      <td>2020-03-25 20:27:12.545942400</td>
      <td>41.851171</td>
      <td>-77.461965</td>
      <td>2020</td>
      <td>3</td>
      <td>13</td>
      <td>9.409645e+06</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">buff1000m</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">buff1000m</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">buff1000m</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;idx&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">share_space_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">buff1000m</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">main_poly</span> <span class="o">=</span> <span class="n">buff1000m</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>
<span class="c1">#     print(&#39;\n&#39; + &#39;Main polygon to be overlaid:&#39;, main_poly[&#39;person_week&#39;].values.tolist()[:])</span>

    <span class="n">other_poly_list</span> <span class="o">=</span> <span class="n">buff1000m</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">other_poly_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    <span class="n">other_poly</span> <span class="o">=</span> <span class="n">buff1000m</span><span class="p">[</span><span class="n">buff1000m</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">other_poly_list</span><span class="p">)]</span>
<span class="c1">#     print(&#39;Polygons to be overlaid:&#39;, other_poly[&#39;person_week&#39;].values.tolist()[:])</span>

    <span class="n">share_space</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">overlay</span><span class="p">(</span><span class="n">main_poly</span><span class="p">,</span> <span class="n">other_poly</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;intersection&#39;</span><span class="p">)</span>
    <span class="n">share_space</span><span class="p">[</span><span class="s1">&#39;share_space&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">share_space</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">area</span>

    <span class="n">share_space_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">share_space</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">share_space_list</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(8, 29)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;person_week_1&#39;</span><span class="p">,</span><span class="s1">&#39;person_week_2&#39;</span><span class="p">,</span><span class="s1">&#39;week_1&#39;</span><span class="p">,</span><span class="s1">&#39;week_2&#39;</span><span class="p">,</span><span class="s1">&#39;share_space&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>person_week_1</th>
      <th>person_week_2</th>
      <th>week_1</th>
      <th>week_2</th>
      <th>share_space</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P1_18</td>
      <td>P2_5</td>
      <td>18.0</td>
      <td>5.0</td>
      <td>9.145960e+04</td>
    </tr>
    <tr>
      <th>0</th>
      <td>P1_27</td>
      <td>P2_12</td>
      <td>27.0</td>
      <td>12.0</td>
      <td>1.439406e+06</td>
    </tr>
    <tr>
      <th>0</th>
      <td>P1_28</td>
      <td>P2_4</td>
      <td>28.0</td>
      <td>4.0</td>
      <td>3.537871e+05</td>
    </tr>
    <tr>
      <th>0</th>
      <td>P2_12</td>
      <td>P1_27</td>
      <td>12.0</td>
      <td>27.0</td>
      <td>1.439406e+06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P2_12</td>
      <td>P2_31</td>
      <td>12.0</td>
      <td>31.0</td>
      <td>3.973167e+05</td>
    </tr>
    <tr>
      <th>0</th>
      <td>P2_31</td>
      <td>P2_12</td>
      <td>31.0</td>
      <td>12.0</td>
      <td>3.973167e+05</td>
    </tr>
    <tr>
      <th>0</th>
      <td>P2_4</td>
      <td>P1_28</td>
      <td>4.0</td>
      <td>28.0</td>
      <td>3.537871e+05</td>
    </tr>
    <tr>
      <th>0</th>
      <td>P2_5</td>
      <td>P1_18</td>
      <td>5.0</td>
      <td>18.0</td>
      <td>9.145960e+04</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">share_space</span></code> column represents the shared space between P1 and P2 on a weekly basis. Because we compiled the example data randomly, there are not many interactions measured by overlapping activity space on a weekly basis even we use buffer distance of 1000 meters to calculate their activity space. For example, there is a shared space of 9.145960e+04 (~ 91459.6) square meters between P1 at the 18th week of 2020 and P2 at the 5th week of 2020.</p>
<p>Please be aware that the above scripts overlay each row on every another row in the data, so there are duplicates, you can select the rows you want to keep. For example, if you are interested in who have shared space with P1, you can just keep those start with P1 in the <code class="docutils literal notranslate"><span class="pre">person_week_1</span></code> (or <code class="docutils literal notranslate"><span class="pre">person_week_2</span></code>) column and export to whatever data formats you want to work with.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="measuring_distance.html" class="btn btn-neutral float-right" title="Measuring Distance" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="building_spatial_data.html" class="btn btn-neutral float-left" title="Building Spatial Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Shuai Zhou

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>